<!-- Any change to the README file must be must be done on README.md.gotmpl file -->

# perses

Perses helm chart

![Version: 0.13.3](https://img.shields.io/badge/Version-0.13.3-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: v0.50.3](https://img.shields.io/badge/AppVersion-v0.50.3-informational?style=flat-square)

## Installing the Chart

To install the chart with the release name `my-release`:

```
helm repo add perses https://perses.github.io/helm-charts
helm repo update
helm install my-release perses/perses
```

## Uninstalling the Chart

To uninstall/delete the my-release deployment:

```
helm delete my-release
```

## Upgrading an existing Release to a new version with Breaking Changes

We try as much as possible to avoid breaking changes, but sometimes it's necessary to introduce them. If you are upgrading from a version to another that contains breaking changes, you will need to follow the steps below,
based on the version you are upgrading from.

### To 0.8.0

This version introduces a breaking change on the `config` section. Some fields on the `config` section has been renamed. You will need to update your values file to reflect the new field names.

Update `security` Fields

- Change `readOnly` to `readonly`.
- Change `enableAuth` to `enable_auth`.

**Before:**

```yaml
security:
  readOnly: false
  enableAuth: false
```

**After:**

```yaml
security:
  readonly: false
  enable_auth: false
```

Move the important_dashboards list into a new frontend section.

**Before:**

```yaml
important_dashboards:
- name: "My Dashboard"
    url: "https://my-dashboard.com"
```

**After:**

```yaml
frontend:
  important_dashboards:
  - name: "My Dashboard"
    url: "https://my-dashboard.com"
```

SQL Field is not defined by default anymore. If you want to enable SQL and file system storage is the default.

## Values

| Key                                  | Type   | Default                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Description                                                                                                                                                                                                                                                                                                     |
|--------------------------------------|--------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| additionalLabels                     | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                 |
| annotations                          | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Statefulset Annotations                                                                                                                                                                                                                                                                                         |
| config                               | object | `{"annotations":{},"api_prefix":"","database":{"file":{"extension":"json","folder":"/perses"}},"frontend":{"explorer":{"enable":true},"important_dashboards":[]},"provisioning":{"folders":["/etc/perses/provisioning"],"interval":"10m"},"schemas":{"datasources_path":"/etc/perses/cue/schemas/datasources","interval":"5m","panels_path":"/etc/perses/cue/schemas/panels","queries_path":"/etc/perses/cue/schemas/queries","variables_path":"/etc/perses/cue/schemas/variables"},"security":{"cookie":{"same_site":"lax","secure":false},"enable_auth":false,"readonly":false}}` | Perses configuration file ref: https://github.com/perses/perses/blob/main/docs/configuration/configuration.md                                                                                                                                                                                                   |
| config.annotations                   | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Annotations for config                                                                                                                                                                                                                                                                                          |
| config.api_prefix                    | string | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Use it in case you want to prefix the API path. By default the API is served with the path /api. With this config, it will be served with the path <api_prefix>/api                                                                                                                                             |
| config.database                      | object | `{"file":{"extension":"json","folder":"/perses"}}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Database config based on data base type                                                                                                                                                                                                                                                                         |
| config.database.file                 | object | `{"extension":"json","folder":"/perses"}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | file system configs                                                                                                                                                                                                                                                                                             |
| config.frontend                      | object | `{"explorer":{"enable":true},"important_dashboards":[]}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Frontend configuration                                                                                                                                                                                                                                                                                          |
| config.frontend.important_dashboards | list   | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Important dashboards list                                                                                                                                                                                                                                                                                       |
| config.provisioning                  | object | `{"folders":["/etc/perses/provisioning"],"interval":"10m"}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | provisioning config                                                                                                                                                                                                                                                                                             |
| config.schemas                       | object | `{"datasources_path":"/etc/perses/cue/schemas/datasources","interval":"5m","panels_path":"/etc/perses/cue/schemas/panels","queries_path":"/etc/perses/cue/schemas/queries","variables_path":"/etc/perses/cue/schemas/variables"}`                                                                                                                                                                                                                                                                                                                                                   | Schemas paths                                                                                                                                                                                                                                                                                                   |
| config.security.cookie               | object | `{"same_site":"lax","secure":false}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | cookie config                                                                                                                                                                                                                                                                                                   |
| config.security.enable_auth          | bool   | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Enable Authentication                                                                                                                                                                                                                                                                                           |
| config.security.readonly             | bool   | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Configure Perses instance as readonly                                                                                                                                                                                                                                                                           |
| datasources                          | list   | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Configure datasources DEPRECATED: This field will be removed in the future release. Please use the 'sidecar' configuration to provision datasources. ref: https://github.com/perses/perses/blob/90beed356243208f14cf2249bebb6f6222cb77ae/docs/datasource.md                                                     |
| extraArgs                            | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Additional arguments to pass to perses. Set to null for argumentless flags                                                                                                                                                                                                                                      |
| fullnameOverride                     | string | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Override fully qualified app name                                                                                                                                                                                                                                                                               |
| image.name                           | string | `"persesdev/perses"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Perses image repository and name                                                                                                                                                                                                                                                                                |
| image.pullPolicy                     | string | `"IfNotPresent"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Default image pull policy                                                                                                                                                                                                                                                                                       |
| image.version                        | string | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Overrides the image tag whose default is the chart appVersion.                                                                                                                                                                                                                                                  |
| ingress                              | object | `{"annotations":{},"enabled":false,"hosts":[{"host":"perses.local","paths":[{"path":"/","pathType":"Prefix"}]}],"ingressClassName":"","tls":[]}`                                                                                                                                                                                                                                                                                                                                                                                                                                    | Configure the ingress resource that allows you to access Perses Frontend ref: https://kubernetes.io/docs/concepts/services-networking/ingress/                                                                                                                                                                  |
| ingress.annotations                  | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Additional annotations for the Ingress resource. To enable certificate autogeneration, place here your cert-manager annotations. For a full list of possible ingress annotations, please see ref: https://github.com/kubernetes/ingress-nginx/blob/master/docs/user-guide/nginx-configuration/annotations.md    |
| ingress.enabled                      | bool   | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Enable ingress controller resource                                                                                                                                                                                                                                                                              |
| ingress.hosts                        | list   | `[{"host":"perses.local","paths":[{"path":"/","pathType":"Prefix"}]}]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Default host for the ingress resource                                                                                                                                                                                                                                                                           |
| ingress.ingressClassName             | string | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | IngressClass that will be be used to implement the Ingress (Kubernetes 1.18+) This is supported in Kubernetes 1.18+ and required if you have more than one IngressClass marked as the default for your cluster . ref: https://kubernetes.io/blog/2020/04/02/improvements-to-the-ingress-api-in-kubernetes-1.18/ |
| ingress.tls                          | list   | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Ingress TLS configuration                                                                                                                                                                                                                                                                                       |
| livenessProbe                        | object | `{"enabled":true,"failureThreshold":5,"initialDelaySeconds":10,"periodSeconds":60,"successThreshold":1,"timeoutSeconds":5}`                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Liveness probe configuration Ref: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/                                                                                                                                                                         |
| logLevel                             | string | `"info"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Log level for Perses be configured in available options "panic", "error", "warning", "info", "debug", "trace"                                                                                                                                                                                                   |
| nameOverride                         | string | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Override name of the chart used in Kubernetes object names.                                                                                                                                                                                                                                                     |
| persistence                          | object | `{"accessModes":["ReadWriteOnce"],"annotations":{},"enabled":false,"labels":{},"securityContext":{"fsGroup":2000},"size":"8Gi"}`                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Persistence parameters                                                                                                                                                                                                                                                                                          |
| persistence.accessModes              | list   | `["ReadWriteOnce"]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | PVC Access Modes for data volume                                                                                                                                                                                                                                                                                |
| persistence.annotations              | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Annotations for the PVC                                                                                                                                                                                                                                                                                         |
| persistence.enabled                  | bool   | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | If disabled, it will use a emptydir volume                                                                                                                                                                                                                                                                      |
| persistence.labels                   | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Labels for the PVC                                                                                                                                                                                                                                                                                              |
| persistence.securityContext          | object | `{"fsGroup":2000}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Security context for the PVC when persistence is enabled                                                                                                                                                                                                                                                        |
| persistence.size                     | string | `"8Gi"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | PVC Storage Request for data volume                                                                                                                                                                                                                                                                             |
| readinessProbe                       | object | `{"enabled":true,"failureThreshold":5,"initialDelaySeconds":5,"periodSeconds":10,"successThreshold":1,"timeoutSeconds":5}`                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Readiness probe configuration Ref: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/                                                                                                                                                                        |
| replicas                             | int    | `1`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Number of pod replicas.                                                                                                                                                                                                                                                                                         |
| resources                            | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Resource limits & requests. Update according to your own use case as these values might be too low for a typical deployment. ref: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/                                                                                                |
| service                              | object | `{"annotations":{},"labels":{},"port":8080,"portName":"http","targetPort":8080,"type":"ClusterIP"}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Expose the Perses service to be accessed from outside the cluster (LoadBalancer service). or access it from within the cluster (ClusterIP service). Set the service type and the port to serve it.                                                                                                              |
| service.annotations                  | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Annotations to add to the service                                                                                                                                                                                                                                                                               |
| service.labels                       | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Labels to add to the service                                                                                                                                                                                                                                                                                    |
| service.port                         | int    | `8080`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Service Port                                                                                                                                                                                                                                                                                                    |
| service.portName                     | string | `"http"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Service Port Name                                                                                                                                                                                                                                                                                               |
| service.targetPort                   | int    | `8080`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Perses running port                                                                                                                                                                                                                                                                                             |
| service.type                         | string | `"ClusterIP"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Service Type                                                                                                                                                                                                                                                                                                    |
| serviceAccount                       | object | `{"annotations":{},"create":true,"name":""}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Service account for Perses to use.                                                                                                                                                                                                                                                                              |
| serviceAccount.annotations           | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Annotations to add to the service account                                                                                                                                                                                                                                                                       |
| serviceAccount.create                | bool   | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Specifies whether a service account should be created                                                                                                                                                                                                                                                           |
| serviceAccount.name                  | string | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | The name of the service account to use. If not set and create is true, a name is generated using the fullname template                                                                                                                                                                                          |
| serviceMonitor.interval              | string | `"30s"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Interval for the serviceMonitor                                                                                                                                                                                                                                                                                 |
| serviceMonitor.labels                | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Labels to add to the ServiceMonitor so that Prometheus can discover it. These labels should match the 'serviceMonitorSelector.matchLabels' defined in your Prometheus CR.                                                                                                                                       |
| serviceMonitor.selector.matchLabels  | object | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Selector used by the ServiceMonitor to find which Perses service to scrape metrics from. These matchLabels should match the labels on your Perses service.                                                                                                                                                      |
| serviceMonitor.selfMonitor           | bool   | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Create a serviceMonitor for Perses                                                                                                                                                                                                                                                                              |
| sidecar                              | object | `{"allNamespaces":true,"enabled":false,"image":{"repository":"kiwigrid/k8s-sidecar","tag":"1.30.2"},"label":"perses.dev/resource","labelValue":"true"}`                                                                                                                                                                                                                                                                                                                                                                                                                             | Sidecar configuration that watches for ConfigMaps with the specified label/labelValue and loads them into Perses provisioning                                                                                                                                                                                   |
| sidecar.allNamespaces                | bool   | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | check for configmaps from all namespaces. When set to false, it will only check for configmaps in the same namespace as the Perses instance                                                                                                                                                                     |
| sidecar.enabled                      | bool   | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Enable the sidecar container for ConfigMap provisioning                                                                                                                                                                                                                                                         |
| sidecar.image.repository             | string | `"kiwigrid/k8s-sidecar"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Container image repository for the sidecar                                                                                                                                                                                                                                                                      |
| sidecar.image.tag                    | string | `"1.30.2"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Container image tag for the sidecar                                                                                                                                                                                                                                                                             |
| sidecar.label                        | string | `"perses.dev/resource"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Label key to watch for ConfigMaps containing Perses resources                                                                                                                                                                                                                                                   |
| sidecar.labelValue                   | string | `"true"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Label value to watch for ConfigMaps containing Perses resources                                                                                                                                                                                                                                                 |
| testFramework.enabled                | bool   | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                 |
| testFramework.image.registry         | string | `"ghcr.io"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                 |
| testFramework.image.repository       | string | `"cloudoperators/greenhouse-extensions-integration-test"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                 |
| testFramework.image.tag              | string | `"main"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                 |
| testFramework.imagePullPolicy        | string | `"IfNotPresent"`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                 |
| volumeMounts                         | list   | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Additional VolumeMounts on the output StatefulSet definition.                                                                                                                                                                                                                                                   |
| volumes                              | list   | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Additional volumes on the output StatefulSet definition.                                                                                                                                                                                                                                                        |

---

Autogenerated from chart metadata using [helm-docs v1.14.2](https://github.com/norwoodj/helm-docs/releases/v1.14.2)
